(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const M={audio:!1,video:{}};class R{constructor(e){this.navigator=e}async getCameraStream(){try{return await this.navigator.mediaDevices.getUserMedia(M)}catch(e){throw new Error(e)}}}var g={exports:{}},f=typeof Reflect=="object"?Reflect:null,y=f&&typeof f.apply=="function"?f.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},p;f&&typeof f.ownKeys=="function"?p=f.ownKeys:Object.getOwnPropertySymbols?p=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:p=function(e){return Object.getOwnPropertyNames(e)};function N(t){console&&console.warn&&console.warn(t)}var w=Number.isNaN||function(e){return e!==e};function a(){a.init.call(this)}g.exports=a;g.exports.once=B;a.EventEmitter=a;a.prototype._events=void 0;a.prototype._eventsCount=0;a.prototype._maxListeners=void 0;var L=10;function m(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return L},set:function(t){if(typeof t!="number"||t<0||w(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");L=t}});a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};a.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||w(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function E(t){return t._maxListeners===void 0?a.defaultMaxListeners:t._maxListeners}a.prototype.getMaxListeners=function(){return E(this)};a.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var u=s[e];if(u===void 0)return!1;if(typeof u=="function")y(u,this,n);else for(var d=u.length,h=O(u,d),i=0;i<d;++i)y(h[i],this,n);return!0};function b(t,e,n,i){var r,s,o;if(m(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),r=E(t),r>0&&o.length>r&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,N(c)}return t}a.prototype.addListener=function(e,n){return b(this,e,n,!1)};a.prototype.on=a.prototype.addListener;a.prototype.prependListener=function(e,n){return b(this,e,n,!0)};function j(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function x(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=j.bind(i);return r.listener=n,i.wrapFn=r,r}a.prototype.once=function(e,n){return m(n),this.on(e,x(this,e,n)),this};a.prototype.prependOnceListener=function(e,n){return m(n),this.prependListener(e,x(this,e,n)),this};a.prototype.removeListener=function(e,n){var i,r,s,o,c;if(m(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===n||i[o].listener===n){c=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():T(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,c||n)}return this};a.prototype.off=a.prototype.removeListener;a.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function _(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?D(r):O(r,r.length)}a.prototype.listeners=function(e){return _(this,e,!0)};a.prototype.rawListeners=function(e){return _(this,e,!1)};a.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):C.call(t,e)};a.prototype.listenerCount=C;function C(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]};function O(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function T(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function D(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function B(t,e){return new Promise(function(n,i){function r(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}I(t,e,s,{once:!0}),e!=="error"&&F(t,r,{once:!0})})}function F(t,e,n){typeof t.on=="function"&&I(t,"error",e,n)}function I(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}class V extends g.exports.EventEmitter{constructor({videoId:e}){super(),this.video=document.getElementById(e),this.interval=null}setupVideoElement({width:e,height:n}){this.video.width=e,this.video.height=n}addStream(e){this.addStreamToVideoElement(e),this.addEventForLoadedVideo()}addStreamToVideoElement(e){"srcObject"in this.video&&(this.video.srcObject=e)}addEventForLoadedVideo(){this.video.addEventListener("loadedmetadata",()=>{this.emit("loaded-video",this.video)})}}const v=4;class H{constructor({canvasId:e}){this.canvas=document.getElementById(e),this.context=this.canvas.getContext("2d")}setupCanvas({width:e,height:n}){this.canvas.width=e,this.canvas.height=n,this.context.scale(-1,1)}drawImage(e){this.context.drawImage(e,0,0,-1*this.canvas.width,this.canvas.height)}getPixelsMatrix(){return this.getPixels().reduce((n,i,r)=>(r%this.canvas.width===0&&n.push([]),n[n.length-1].push(i),n),[])}getPixels(){const e=this.canvasData();return Array.from(Array(Math.ceil(e.length/v)),(i,r)=>e.slice(r*v,r*v+v))}canvasData(){return this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data}}const W=()=>{const t=document.createElement("pre");t.style.position="absolute",t.style.margin="0",t.textContent="#",document.getElementById("app").appendChild(t);const e=t.getBoundingClientRect();return t.remove(),e},K=()=>{const t=W();return{width:window.innerWidth,height:window.innerHeight,gridWidth:Math.ceil(window.innerWidth/t.width),gridHeight:Math.ceil(window.innerHeight/t.height)}},l=["\u2591","\u2584","\u2580","\u2588"];class ${constructor(e,{redLayerId:n,greenLayerId:i,blueLayerId:r}){this.board=document.getElementById(e),this.red=document.getElementById(n),this.green=document.getElementById(i),this.blue=document.getElementById(r)}displayPixelsOnLayers(e=[[]]){const[n,i,r]=this.convertPixelsToString(e);this.red.textContent=n,this.green.textContent=i,this.blue.textContent=r}convertPixelsToString(e=[[]]){let n="",i="",r="";return e.forEach(s=>{const[o,c,u]=s.reduce((d,h)=>{const S=Math.floor(h[0]/255*(l.length-1)),P=Math.floor(h[1]/255*(l.length-1)),A=Math.floor(h[2]/255*(l.length-1));return d[0].push(l[S]),d[1].push(l[P]),d[2].push(l[A]),d},[[],[],[]]);n=`${n}${o.join("")}
`,i=`${i}${c.join("")}
`,r=`${r}${u.join("")}
`}),[n,i,r]}}const U=60,z="video",k="canvas",q="board",G={redLayerId:"red-layer",greenLayerId:"green-layer",blueLayerId:"blue-layer"};window.addEventListener("load",async()=>{navigator&&navigator.mediaDevices?Y():console.error("[APP] No Media Ouput")});const Y=async()=>{let t=null;try{const e=new R(navigator),n=new V({videoId:z}),i=new H({canvasId:k}),r=new $(q,G),{width:s,height:o}=J();i.setupCanvas({width:s,height:o}),n.setupVideoElement({width:s,height:o});const c=await e.getCameraStream();n.addStream(c),n.on("loaded-video",u=>{t=setInterval(()=>Q(u,i,r),U)})}catch(e){throw new Error(e)}finally{clearInterval(t)}},J=()=>{const t=K(),e=t.gridHeight;return{width:t.gridHeight/3*4,height:e}},Q=(t,e,n)=>{e.drawImage(t);const i=e.getPixelsMatrix();n.displayPixelsOnLayers(i)};
